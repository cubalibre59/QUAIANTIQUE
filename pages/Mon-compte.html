<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Mon Compte - Quai Antique</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <style>
   
    body {
      transition: background-color 0.3s ease;
    }
    .profile-img {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
    }
    .settings-box {
      margin-top: 2rem;
      padding: 1rem;
      background-color: #f9f9f9;
      border-radius: 10px;
    }
  </style>
  <style>
  .nav-link:hover {
    color: #FF8C00 !important;
  }
</style>

    <style>
      body {
        padding-top: 70px; /* espacio para la navbar fija */
      }
      .bg-cyan-dark {
        background-color: #027B9A; /* cian oscuro personalizado */
      }
      .navbar-brand img {
        height: 80px;
      }
    </style>
   <style>
.card-sushi {
  background-image: url(../images/image-sushi10.jpg);
  background-size: cover;

}
 </style> 
</head>
<body>
   <!-- chatflow :research engine  -->
  import { BubbleChat } from 'flowise-embed-react'

const App = () => {
    return (
        <BubbleChat
            chatflowid="b8af5cbd-9a3b-4ab3-8a5d-a5f108069c5d"
            apiHost="https://cloud.flowiseai.com"
        />
    );
};

   <!-- NAVBAR FIJA -->
      <header class="header-bg">
    <nav class="navbar navbar-expand-lg navbar-dark bg-cyan-dark fixed-top">
      <div class="container-fluid">
        <a class="navbar-brand" href="/">
          <img src="../images/logoquaiantique.png" alt="LogoQuaiAntique" />
        </a>
    
    
      <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>


<!-- Navbar links -->
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a class="nav-link active" href="/" data-link>Accueil</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/connexion" data-link>Connexion</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/contact" data-link>Contact</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/menu" data-link>Menu</a>
            </li>
             <li class="nav-item">
              <a class="nav-link" href="/signup" data-link>Signup</a>
            </li>
             <li class="nav-item">
              <a class="nav-link" href="/reserver" data-link>Reserver</a>
            </li>
              <li class="nav-item">
              <a class="nav-link" href="/Mon-compte"  data-link>Mon-compte</a>
            </li>
             <li class="nav-item">
              <button class="nav-link" id="signout-Btn" data-link>Deconnexion</button>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    </header>
<div id="app"></div>
<div class="container mt-5">
  <div class="text-center">
    <img src="" id="profileImg" class="profile-img mb-3" alt="Avatar">
    <h2 id="displayName">Bienvenue, Client</h2>
    <p>Email : <span id="displayEmail"></span></p>
    <p>RÃ´le : <span id="displayRole">client</span></p>
  </div>

  <div class="settings-box">
    <h4>ðŸ”§ Personnaliser ma page</h4>

    <div class="mb-3">
      <label for="customName" class="form-label">Nom Ã  afficher</label>
      <input type="text" id="customName" class="form-control" placeholder="Entrez votre nom">
    </div>

    <div class="mb-3">
      <label for="bgColor" class="form-label">Couleur de fond</label>
      <input type="color" id="bgColor" class="form-control form-control-color" value="#f2f2f2">
    </div>

    <div class="mb-3">
      <label for="uploadAvatar" class="form-label">Changer ma photo</label>
      <input type="file" id="uploadAvatar" class="form-control">
    </div>

    <button class="btn btn-success" onclick="savePreferences()">ðŸ’¾ Enregistrer mes prÃ©fÃ©rences</button>
    <button class="btn btn-danger" onclick="logout()">ðŸšª Se dÃ©connecter</button>
  </div>
</div>

<script>
  // Chargement des infos
  const user = JSON.parse(localStorage.getItem("user"));
  if (!user) window.location.replace("/");

  // Initialisation
  document.getElementById("displayName").textContent = user.name || "Client";
  document.getElementById("displayEmail").textContent = user.email || "";
  document.getElementById("displayRole").textContent = user.role || "client";

  // Cargar preferencias
  const prefs = JSON.parse(localStorage.getItem("prefs_" + user.email)) || {};
  if (prefs.name) document.getElementById("displayName").textContent = prefs.name;
  if (prefs.bgColor) document.body.style.backgroundColor = prefs.bgColor;
  if (prefs.avatar) document.getElementById("profileImg").src = prefs.avatar;
  else document.getElementById("profileImg").src = "https://via.placeholder.com/100";

  // Guardar preferencias
  function savePreferences() {
    const newName = document.getElementById("customName").value;
    const newColor = document.getElementById("bgColor").value;
    const avatarFile = document.getElementById("uploadAvatar").files[0];

    const newPrefs = {
      name: newName || user.name,
      bgColor: newColor,
      avatar: prefs.avatar || ""
    };

    // Imagen como base64
    if (avatarFile) {
      const reader = new FileReader();
      reader.onload = () => {
        newPrefs.avatar = reader.result;
        localStorage.setItem("prefs_" + user.email, JSON.stringify(newPrefs));
        location.reload();
      };
      reader.readAsDataURL(avatarFile);
    } else {
      localStorage.setItem("prefs_" + user.email, JSON.stringify(newPrefs));
      location.reload();
    }
  }

  function logout() {
    localStorage.removeItem("user");
    window.location.href = "/";
   }
 //  AquÃ­ expones las funciones globalmente para que funcionen con onclick
window.savePreferences = savePreferences;
window.logout = logout;
</script>
<!--ImportaciÃ³n del chatbot 21/07/25-->
 <script type="module">
    import Chatbot from "https://cdn.jsdelivr.net/npm/flowise-embed/dist/web.js"
    Chatbot.init({
        chatflowid: "1b03d24b-c1d2-42d7-b5e7-41f294cc336e",
        apiHost: "https://cloud.flowiseai.com",
    })
</script> 
 
<!--rajoute complement de admin.html besoin etre inscrpts 26/07-->
<script type="module">
  import { protectPage } from "../js/auth/auth.guard.js";
  protectPage(); // No necesita rol
</script>


<footer class="text-white pt-4" style="background-color: #5a1c0a;">
  <div class="container text-center text-md-start">
    <div class="row">

      <!-- Columna connexion-->
      <div class="col-md-3 mb-3">
        <h5 class="fw-bold text-warning">Restons  en contact </h5>
        <ul class="list-unstyled">
          <li>Notre Histoire</li>
          <li>Soutien</li>
        </ul>
      </div>

      <!-- Columna LIEN -->
      <div class="col-md-3 mb-3">
        <h5 class="fw-bold text-warning">lien</h5>
        <ul class="list-unstyled">
          <li>Instagram</li>
        </ul>
      </div>

      <!-- Columna SOUTIEN -->
      <div class="col-md-3 mb-3">
        <h5 class="fw-bold text-warning">soutien</h5>
        <ul class="list-unstyled">
          <li>info@email.com</li>
        </ul>
      </div>

      <!-- Columna con fondo verde e Ã­conos -->
      <div class="col-md-3 mb-3" style="background-color: #15724b;">
        <div class="d-flex flex-column align-items-center justify-content-center h-100">
          <i class="bi bi-apple fs-3 mb-2"></i>
          <i class="bi bi-envelope-plus-fill fs-3"></i>
        </div>
      </div>
    </div>

    <!-- LÃ­nea inferior -->
    <div class="text-center pt-3 text-warning fw-bold fst-italic">
      code ville 91700 - 02 45 80 ...
    </div>
  </div>
</footer>
<div class="container mt-5">
  <footer class="text-center py-4">
    <p>&copy; 2023 Quai Antique. Tous droits rÃ©servÃ©s.</p>
    <p>Suivez-nous sur nos rÃ©seaux sociaux</p>
    <a href="#" class="btn btn-secondary">Facebook</a>
    <a href="#" class="btn btn-secondary">Instagram</a>
  </footer>
 <!-- Lien vers le fichier JS -->
 <script  type="module" src="../js/script.js"></script>
<script  type="module" src="../js/connexion.js"></script>
<script  type="module" src="../js/signup.js"></script>
<script type="module" src="../Router/allroute.js"></script>
</body>
</html>
